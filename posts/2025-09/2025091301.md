---
title: 【题解】Luogu P6441 [COCI 2011 2012 #6] PASTELE
filename: 2025091301
tags:
  - 二分
  - 前缀和
categories:
  - OI
date: 2025-09-13
description: 
articleGPT: 这篇题解巧妙地将问题转化为三维空间中的立方体点计数问题，并通过**二分答案**和**三维前缀和**这一经典组合，高效地解决了问题。其亮点在于对题意的深刻理解以及将算法与数据结构（前缀和）应用于三维场景的能力。代码实现清晰，包含了预处理、二分和输出结果三个主要部分。
cover: https://www.chickoi.com/nav_logo_dark.png
top: false
share: true
delete: false
---

注意到 `请找出 k 支蜡笔，使得色彩值最小。`，结合题意可得：色彩值越大，满足条件的蜡笔数量越多。故考虑二分答案。

发现 `对于两支蜡笔` 和 `任意两支` 看起来有点难维护啊，但是这里有个很妙的东西：\
我们可以把第 $i$ 支蜡笔的 $(r_i,g_i,b_i)$ 当成点的坐标。

然后转化一下部分题意：
> 给出 $n$ 个三维空间内的点，问是否存在一个长方体，使得其中恰好有 $k$ 个点。

哦那很好办了，直接扔个三维前缀和统计一个正方体内出现的点的个数就行。\
具体的：令二分的值为 $w$（即正方体棱长为 $w$），在 $check$ 函数里面枚举一个三维空间内的点 $(i,j,k)$（此为正方体中三个坐标值最小的点），用前缀和统计这个正方体内的点的个数，看看是否符合要求。其中，对于每个点 $(x,y,z)$，$i,j,k$ 满足 $i\leq x\leq i+w,j\leq y\leq j+w,k\leq z\leq k+w$。

如果你不会三维前缀和？
> 可以上网搜一搜，是有规律的（不必自己推）。

为什么能这么做？\
因为：$0\le R_i,G_i,B_i\le 256$。

于是我们以 $\mathcal{O}(V^3\log V)$ 的时间复杂度过掉了这道题。

## Code
```cpp
#include<bits/stdc++.h>

typedef int IT;
typedef long long LL;
typedef __int128 int128;
typedef double DB;
typedef long double LDB;

#define pb push_back
#define fst first
#define sec second
#define psh push
#define mkp make_pair
#define PII pair<IT,IT>
#define PLI pair<LL,IT>
#define lowbit(x) ((x)&(-x))

using namespace std;

const int N=1e5+10,V=257;

int n,K;
int r[N],g[N],b[N];

int sum[V+6][V+6][V+6],a[V+6][V+6][V+6];

bool check(int w){
    for(int i=1;i+w<=V;i++){
        for(int j=1;j+w<=V;j++){
            for(int k=1;k+w<=V;k++){
                int x=i+w,y=j+w,z=k+w;
                int cnt=sum[x][y][z]-sum[i-1][y][z]-sum[x][j-1][z]-sum[x][y][k-1]
                        +sum[i-1][j-1][z]+sum[i-1][y][k-1]+sum[x][j-1][k-1]-sum[i-1][j-1][k-1];
                if(cnt>=K) return 1;
            }
        }
    }

    return 0;
}

void print(int w){
    printf("%d\n",w);

    for(int i=1;i+w<=V;i++){
        for(int j=1;j+w<=V;j++){
            for(int k=1;k+w<=V;k++){
                int x=i+w,y=j+w,z=k+w;
                int cnt=sum[x][y][z]-sum[i-1][y][z]-sum[x][j-1][z]-sum[x][y][k-1]
                        +sum[i-1][j-1][z]+sum[i-1][y][k-1]+sum[x][j-1][k-1]-sum[i-1][j-1][k-1];
                if(cnt>=K){
                    int tot=0;
                    for(int t=1;t<=n;t++){
                        if(r[t]>=i && r[t]<=x && g[t]>=j && g[t]<=y && b[t]>=k && b[t]<=z){
                            r[t]--,g[t]--,b[t]--;
                            printf("%d %d %d\n",r[t],g[t],b[t]);
                            tot++;
                            if(tot==K) break;
                        }
                    }
                    return;
                }
            }
        }
    }
    return;
}

int main(){
    scanf("%d %d",&n,&K);
    for(int i=1;i<=n;i++){
        scanf("%d %d %d",&r[i],&g[i],&b[i]);
        r[i]++,g[i]++,b[i]++;
        a[r[i]][g[i]][b[i]]++;
    }

    for(int i=1;i<=V;i++){
        for(int j=1;j<=V;j++){
            for(int k=1;k<=V;k++){
                sum[i][j][k]=a[i][j][k]+sum[i-1][j][k]+sum[i][j-1][k]+sum[i][j][k-1]
                    -sum[i-1][j-1][k]-sum[i-1][j][k-1]-sum[i][j-1][k-1]+sum[i-1][j-1][k-1];
            }
        }
    }

    int l=0,r=V,res=-1;
    while(l<=r){
        int mid=(l+r)>>1;
        if(check(mid)) r=mid-1,res=mid;
        else l=mid+1;
    }

    print(res);
    return 0;
}
```
[Link](https://www.luogu.com.cn/record/235205681)
